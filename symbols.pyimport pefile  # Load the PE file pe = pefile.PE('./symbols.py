import pefile

# Load the PE file
pe = pefile.PE('./example-library.dll')

# Display the FILE_HEADER characteristics and number of sections
print(f"Characteristics: {hex(pe.FILE_HEADER.Characteristics)}")
print(f"Number of Sections: {pe.FILE_HEADER.NumberOfSections}")

# List exported symbols
print("\nExported Symbols:")
for exp in pe.DIRECTORY_ENTRY_EXPORT.symbols:
    print(exp.name)

# List imported symbols
print("\nImported Symbols:")
for entry in pe.DIRECTORY_ENTRY_IMPORT:
    print(f"From DLL: {entry.dll.decode('utf-8')}")
    for imp in entry.imports:
        print(f"  {imp.name.decode('utf-8')} at 0x{imp.address:08X}")
